<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Roleta da Sorte Cyberpunk</title>
<style>
  /* === (todo o CSS original permanece) === */
  /* ——-------  ADIÇÕES  -------- */
  .pix-box{margin:18px 0;font-size:1rem;color:#00ffe7aa}
  .pix-box button{margin-left:8px;font-size:.9rem;padding:6px 14px}
  /* Loader de espera */
  .loader-bg{position:fixed;inset:0;background:#000c;display:flex;
    justify-content:center;align-items:center;visibility:hidden;opacity:0;
    transition:.3s;z-index:200}
  .loader-bg.active{visibility:visible;opacity:1}
  .loader{width:70px;height:70px;border:8px solid #00ffe733;border-top-color:#00ffe7;
    border-radius:50%;animation:gira 1s linear infinite}
  @keyframes gira{to{transform:rotate(360deg)}}
</style>
</head>
<body>

<div class="container">
  <h1>Roleta da Sorte</h1>
  <div class="wheel" id="wheel"><div class="pointer"></div><canvas id="canvas" width="300" height="300"></canvas></div>
  <button class="spin-btn" id="spinBtn">Girar</button>
  <div class="tries" id="triesCount">Tentativas: 0</div>
</div>

<!-- Modal de depósito -->
<div class="modal-bg" id="modalBg">
  <div class="modal">
    <h2 id="modalTitle">Parabéns!</h2>
    <p id="modalDesc"></p>
    <input type="number" id="depositValue" readonly />
    <div class="pix-box">
      Chave Pix: <span id="pixKey"></span>
      <button id="copyPixBtn">Copiar</button>
    </div>
    <button id="depositBtn">Depositar</button>
  </div>
</div>

<!-- Loader -->
<div class="loader-bg" id="loaderBg"><div class="loader"></div></div>

<!-- Sons -->
<audio id="soundSpin" src="https://cdn.pixabay.com/download/audio/2021/09/15/audio_b33afc2a2d.mp3?filename=slot-machine-spin-6413.mp3" preload="auto"></audio>
<audio id="soundWin"  src="https://cdn.pixabay.com/download/audio/2022/03/16/audio_8a108251f0.mp3?filename=arcade-game-win-2-6348.mp3" preload="auto"></audio>
<audio id="soundLose" src="https://cdn.pixabay.com/download/audio/2021/08/04/audio_62d707ea23.mp3?filename=arcade-game-lose-5602.mp3" preload="auto"></audio>

<script>
/* ---------- CONFIGURAÇÃO DA ROLETA ---------- */
const segments=[
  {text:"Perdeu",color:"#e74c3c",win:false},
  {text:"100",color:"#27ae60",win:true},
  {text:"Perdeu",color:"#e74c3c",win:false},
  {text:"1.000",color:"#2ecc71",win:true},
  {text:"Perdeu",color:"#e74c3c",win:false},
  {text:"5.000",color:"#16a085",win:true},
  {text:"Perdeu",color:"#e74c3c",win:false},
  {text:"10.000",color:"#1abc9c",win:true},
  {text:"Perdeu",color:"#c0392b",win:false},
  {text:"20.000",color:"#27ae60",win:true},
  {text:"Perdeu",color:"#e74c3c",win:false},
  {text:"50.000",color:"#2ecc71",win:true}
];
const segmentAngle=360/segments.length;
/* ------------------------------------------- */

const canvas=document.getElementById('canvas'),
      ctx=canvas.getContext('2d'),
      spinBtn=document.getElementById('spinBtn'),
      modalBg=document.getElementById('modalBg'),
      depositBtn=document.getElementById('depositBtn'),
      depositValue=document.getElementById('depositValue'),
      triesCount=document.getElementById('triesCount'),
      pixKeySpan=document.getElementById('pixKey'),
      copyPixBtn=document.getElementById('copyPixBtn'),
      modalDesc=document.getElementById('modalDesc'),
      loaderBg=document.getElementById('loaderBg'),
      soundSpin=document.getElementById('soundSpin'),
      soundWin=document.getElementById('soundWin'),
      soundLose=document.getElementById('soundLose');

let startAngle=0,spinTimeout=null,spinAngleStart=0,spinTime=0,spinTimeTotal=0,tries=0;

/* ---------- DESENHO ---------- */
function drawWheel(){
  ctx.clearRect(0,0,canvas.width,canvas.height);
  const R=140,rText=110,rInside=60;
  segments.forEach((seg,i)=>{
    const angle=startAngle+i*segmentAngle*Math.PI/180;
    ctx.fillStyle=seg.color;
    ctx.beginPath();ctx.moveTo(150,150);
    ctx.arc(150,150,R,angle,angle+segmentAngle*Math.PI/180);ctx.fill();
    ctx.save();ctx.fillStyle="#fff";
    ctx.translate(150+Math.cos(angle+segmentAngle*Math.PI/360)*rText,
                  150+Math.sin(angle+segmentAngle*Math.PI/360)*rText);
    ctx.rotate(angle+segmentAngle*Math.PI/360+Math.PI/2);
    ctx.font="bold 18px Arial";ctx.fillText(seg.text,-ctx.measureText(seg.text).width/2,0);
    ctx.restore();
  });
  ctx.beginPath();ctx.arc(150,150,rInside,0,2*Math.PI);ctx.fillStyle="#121212";ctx.fill();
  ctx.lineWidth=5;ctx.strokeStyle="#00ffe7";ctx.stroke();
}
/* ---------- ANIMAÇÃO ---------- */
function spin(){
  spinAngleStart=Math.random()*360+720;
  spinTime=0;spinTimeTotal=Math.random()*3000+4000;
  rotateWheel();spinBtn.disabled=true;soundSpin.currentTime=0;soundSpin.play();
}
function rotateWheel(){
  spinTime+=30;
  if(spinTime>=spinTimeTotal){stopRotateWheel();return;}
  const spinAngle=easeOut(spinTime,0,spinAngleStart,spinTimeTotal);
  startAngle=(spinAngle*Math.PI/180)%(2*Math.PI);drawWheel();
  spinTimeout=setTimeout(rotateWheel,30);
}
function stopRotateWheel(){
  clearTimeout(spinTimeout);soundSpin.pause();
  const degrees=startAngle*180/Math.PI+90,
        index=Math.floor((360-(degrees%360))/segmentAngle)%segments.length;
  tries++;triesCount.textContent=`Tentativas: ${tries}`;
  if(segments[index].win){
    soundWin.currentTime=0;soundWin.play();
    showWinModal(segments[index].text);
  }else{
    soundLose.currentTime=0;soundLose.play();
    alert('Que pena, você perdeu! Tente novamente.');spinBtn.disabled=false;
  }
}
function easeOut(t,b,c,d){const ts=(t/=d)*t,tc=ts*t;return b+c*(tc-3*ts+3*t);}

/* ---------- MODAL DE VITÓRIA ---------- */
function showWinModal(prizeText){
  const prize=parseInt(prizeText.replace(/\./g,''));
  const deposit=(prize*0.10).toFixed(2);
  modalDesc.innerHTML=
    `Você ganhou <strong>R$ ${prize.toLocaleString('pt-BR')}</strong>!<br>`+
    `Deposite <strong>R$ ${Number(deposit).toLocaleString('pt-BR',{minimumFractionDigits:2})}</strong> `+
    `para liberar o saque.`;
  depositValue.value=deposit;
  pixKeySpan.textContent=createPixKey();
  modalBg.classList.add('active');
}
/* chave Pix fictícia */
function createPixKey(){
  return (Math.random().toString(36).slice(2,10)+Date.now().toString(36)).toUpperCase();
}
copyPixBtn.onclick=()=>navigator.clipboard.writeText(pixKeySpan.textContent)
  .then(()=>alert('Chave Pix copiada!'));

/* ---------- DEPÓSITO + ESPERA ---------- */
depositBtn.addEventListener('click',()=>{
  loaderBg.classList.add('active');depositBtn.disabled=true;
  setTimeout(()=>{
    loaderBg.classList.remove('active');depositBtn.disabled=false;
    alert('Depósito confirmado! Seu saque foi liberado.');
    modalBg.classList.remove('active');spinBtn.disabled=false;
  },5000); // 5 s de “espera”
});

/* ---------- EVENTOS E INICIALIZAÇÃO ---------- */
spinBtn.addEventListener('click',spin);
drawWheel();
</script>
</body>
</html>
